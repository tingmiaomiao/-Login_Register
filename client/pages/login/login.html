<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录页</title>
    <link rel="stylesheet" href="./login.css">
    <script src="http://localhost:8001/httpRequest/httpCallback.js"></script>
    <script src="http://localhost:8001/constant.js"></script>
    <script src="http://localhost:8001/jquery-3.3.1.min.js"></script>
    <script src="http://localhost:8001/jquery/jquery.cookie.js"></script>
</head>
<body>
   <div class="wrap">
       <div class="content">
           <div class="filed userName-filed">
               <label for="userName" title="会员名">用户名</label>
                <input type="text" name="userName" id="userName" class="login-text" maxlength="20">
           </div>
           <div class="filed password-filed">  
                <label for="password" title="密码">密码</label>  
                <input type="password" name="password" id="password" class="login-text" maxlength="10">               
            </div>   
            <div class="button ">
                <input type="button" id="submit"  class="submit-text" value="登录" >
            </div>   
            <div class="register">
                <a href="http://localhost:8001/pages/register/register.html" class="register-text">免费注册</a>
                <a href="" class="forget-password">忘记密码</a>
            </div>  
       </div>
   </div> 
</body>
<script>
    const {PATH} = constant;
    var node = document.getElementById('submit');
    var http = new Http();
    node.addEventListener('click',function(){
        var name = document.getElementById('userName').value;
        var password = document.getElementById('password').value;
        var info={
            username:name,
        }
        console.log(PATH)
        http.get(PATH+'/search',info,function(err,result){
            if(err){
                console.log(err)
                return
            }
            var result_password = result.result[0].password;
        
            if(!result_password){
                alert('该用户未注册,请先注册')
                return
            }else if(password == result_password){
                $.cookie("username",name, { expires: 7, path: '/' }); 
                $.cookie("password",result_password, { expires: 7, path: '/' });
                alert('登录成功')
                location.href = PATH + "/pages/index/index.html"
            }else{
                alert('密码错误')
            }
            // console.log(result_password);
        })
        
    })
    
</script>
</html>